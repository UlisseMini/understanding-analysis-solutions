\section{Integrating Functions with Discontinuities}

\begin{exercise} Consider the function
$$
h(x)= \begin{cases}1 & \text { for } 0 \leq x<1 \\ 2 & \text { for } x=1\end{cases}
$$
over the interval $[0,1]$.
\enum{
\item Show that $L(f, P)=1$ for every partition $P$ of $[0,1]$.
\item Construct a partition $P$ for which $U(f, P)<1+1 / 10$.
\item Given $\epsilon>0$, construct a partition $P_{\epsilon}$ for which $U\left(f, P_{\epsilon}\right)<1+\epsilon$.
}
\end{exercise}
\begin{solution}
    \TODO
\end{solution}

\begin{exercise} Recall that Thomae's function
$$
t(x)= \begin{cases}1 & \text { if } x=0 \\ 1 / n & \text { if } x=m / n \in \mathbf{Q} \backslash\{0\} \text { is in lowest terms with } n>0 \\ 0 & \text { if } x \notin \mathbf{Q}\end{cases}
$$
has a countable set of discontinuities occurring at precisely every rational number. Follow these steps to prove $t(x)$ is integrable on $[0,1]$ with $\int_{0}^{1} t=0$.
\enum{
\item First argue that $L(t, P)=0$ for any partition $P$ of $[0,1]$.
\item Let $\epsilon>0$, and consider the set of points $D_{\epsilon / 2}=\{x \in[0,1]: t(x) \geq \epsilon / 2\}$. How big is $D_{\epsilon / 2}$ ?
\item To complete the argument, explain how to construct a partition $P_{\epsilon}$ of $[0,1]$ so that $U\left(t, P_{\epsilon}\right)<\epsilon$.
}
\end{exercise}
\begin{solution}
\enum{
\item Because the irrationals are dense, for any interval there must be some point in that interval where \(t(x) = 0\), which is also the minimum possible value of \(t\); hence \(L(t,P) = 0\).
\item This is the size of the set of rational numbers which, when expressed in lowest terms as \(m/n\), have \(n \leq 2/\epsilon\). This must be finite; let the size of \(D_{\epsilon/2}\) be denoted as \(|D_{\epsilon/2}|\).
\item Informally, we'll set up the partition to ``isolate'' each point in \(D_{\epsilon/2}\). Define the partition as
\[P_\epsilon = \{d + k/2 : d \in D_{\epsilon/2}\} \cup \{d - k/2 : d \in D_{\epsilon/2}\} \cup \{0,1\}\]
where \(k = \epsilon / (2 |D_{\epsilon/2}|)\). (If some of these isolating intervals overlap, then decrease \(k\) until they don't; this can be formalized by requring \(k\) be the minimum of what it is currently and the smallest distance between two points in \(D_{\epsilon/2}\).) Then
\[U(t,P_\epsilon) < \epsilon/2 + k |D_{\epsilon/2}| = \epsilon\]
where the first term comes from all partition intervals that aren't isolating an element in \(D_{\epsilon/2}\), and the second term comes from the elements in \(D_{\epsilon/2}\).
}
\end{solution}

\begin{exercise} Let
$$
f(x)= \begin{cases}1 & \text { if } x=1 / n \text { for some } n \in \mathbf{N} \\ 0 & \text { otherwise. }\end{cases}
$$
Show that $f$ is integrable on $[0,1]$ and compute $\int_{0}^{1} f$.
\end{exercise}
\begin{solution}
    \TODO
\end{solution}

\begin{exercise} Let $f$ and $g$ be functions defined on (possibly different) closed intervals, and assume the range of $f$ is contained in the domain of $g$ so that the composition $g \circ f$ is properly defined.
\enum{
\item Show, by example, that it is not the case that if $f$ and $g$ are integrable, then $g \circ f$ is integrable.
Now decide on the validity of each of the following conjectures, supplying a proof or counterexample as appropriate.
\item If $f$ is increasing and $g$ is integrable, then $g \circ f$ is integrable.
\item If $f$ is integrable and $g$ is increasing, then $g \circ f$ is integrable.
}
\end{exercise}
\begin{solution}
\enum{
\item Let \(f(x)\) be Thomae's function (which we've shown in Exercise 7.3.2 to be integrable), and define \(g\) over the interval \([0,1]\) as
    \[g(x) = \begin{cases}
    0 & x = 0 \\
    1 & x > 0
\end{cases}\]
By Theorem 7.3.2, \(g\) is integrable. But for any rational number \(q\), \(f(q) > 0\), and so \(g \circ f\) is just Dirichlet's function, which is not integrable.

\item False. Note: the following counterexample requires results from Section 7.6.

Let \(c(x)\) be the Cantor Function, defined in Exercise 6.2.12, and consider \(d(x) = c(x) + x\), defined over \([0,1]\). Recall that \(c(x)\) is increasing and continuous; therefore \(d(x)\) is strictly increasing and continuous. Therefore, since \(d\) is one-to-one, \(d^{-1}\) is defined, continuous, and increasing over \([0, 2]\).

Notably, \(c\) maps the Cantor set \(C\) (which has measure zero) to a set of positive measure, since \(c\) maps \([0,1] \backslash C\) to the dyadic points in \([0,1]\), which are countable and thus have measure zero. This behaviour is also true of \(d\). To prove this a bit formally, assume for contradiction that \(d(C) = \{d(x) : x \in C\}\) has measure zero, and find a collection of open intervals with total length less than \(\epsilon\) whose union contains \(d(C)\). For a representative interval \((p_1, p_2) = (d(x_1), d(x_2))\), let \(d(S)\) be the set of points in \(d(C)\) which are covered by \((p_1, p_2)\), where \(S\) be the points in \(C\) which map to \(d(S)\). But note that then \((c(x_1), c(x_2)) \supseteq c(S)\), and that
\[p_2 - p_1 = c(x_2) - c(x_1) - (x_2 - x_1) \geq c(x_2) - c(x_1)\]
Repeating this for every interval leaves us with a collection of intervals covering \(c(C)\) whose total length is less than \(\epsilon\), a contradiction since \(c(C)\) has positive measure.

Finally, let \(f = d^{-1}\) and \(g\) be the indicator function of \(C\); that is,
\[g(x) = \begin{cases}
   1 & x \in C \\
   0 & x \notin C
\end{cases}\]
We show later in Exercise 7.3.9 that \(g\) is integrable and its set of discontinuities is \(C\). But I claim that \(g \circ f\) is discontinuous on \(d(C)\), a set of positive measure. This claim would imply that \(g \circ f\) is not integrable.

Note that \(f^{-1} = d\) is continuous. If \(g \circ f\) was continuous on any point \(x \in d(C)\), then \(g = (g \circ f) \circ f^{-1}\) should be continuous on \(d^{-1}(x) \in C\), but \(g\) is discontinuous over \(C\). Thus a contradiction and \(g \circ f\) is discontinuous over \(d(C)\).

\item False - \(g\) in the example in part (a) was increasing.
}
\end{solution}

\begin{exercise}
    Provide an example or give a reason why the request is impossible.
\enum{
\item A sequence $\left(f_{n}\right) \rightarrow f$ pointwise, where each $f_{n}$ has at most a finite number of discontinuities but $f$ is not integrable.
\item A sequence $\left(g_{n}\right) \rightarrow g$ uniformly where each $g_{n}$ has at most a finite number of discontinuities and $g$ is not integrable.
\item A sequence $\left(h_{n}\right) \rightarrow h$ uniformly where each $h_{n}$ is not integrable but $h$ is integrable.
}
\end{exercise}
\begin{solution}
\enum{
\item Let \((r_n)\) be an enumeration of the rational numbers in \([0, 1]\), let \(R_n\) be the set of \(r_i\) where \(i \leq n\), and let
\[f_n(x) = \begin{cases}
    1 & x \in R_n \\
    0 & \text{otherwise}
\end{cases}\]
Then \(f_n\) has \(n\) discontinuities, and \((f_n)\) approaches Dirichlet's function pointwise.
\item Each \(g_n\) must be integrable, so by Exercise 7.2.5 \(g\) must also be integrable.
\item Letting \(d\) be Dirichlet's function, let \(h_n(x) = d(x) / n\), with \(h(x) = 0\).
}
\end{solution}

\begin{exercise} Let $\left\{r_{1}, r_{2}, r_{3}, \ldots\right\}$ be an enumeration of all the rationals in $[0,1]$, and define
$$
g_{n}(x)= \begin{cases}1 & \text { if } x=r_{n} \\ 0 & \text { otherwise. }\end{cases}
$$
\enum{
\item Is $G(x)=\sum_{n=1}^{\infty} g_{n}(x)$ integrable on $[0,1]$ ?
\item Is $F(x)=\sum_{n=1}^{\infty} g_{n}(x) / n$ integrable on $[0,1]$ ?
}
\end{exercise}
\begin{solution}
\enum{
\item \(G(x)\) is Dirichlet's function and is not integrable
\item The same approach as that used in Exercise 7.3.2 can be used; in particular the set of points \(\{x \in[0,1]: F(x) \geq \epsilon / 2\}\) is finite.
}
\end{solution}

\begin{exercise} Assume $f:[a, b] \rightarrow \mathbf{R}$ is integrable.
\enum{
\item Show that if $g$ satisfies $g(x)=f(x)$ for all but a finite number of points in $[a, b]$, then $g$ is integrable as well.
\item Find an example to show that $g$ may fail to be integrable if it differs from $f$ at a countable number of points.
}
\end{exercise}
\begin{solution}
    \TODO
\end{solution}

\begin{exercise} As in Exercise 7.3.6, let $\left\{r_{1}, r_{2}, r_{3}, \ldots\right\}$ be an enumeration of the rationals in $[0,1]$, but this time define
$$
h_{n}(x)=\left\{\begin{array}{ll}
1 & \text { if } r_{n}<x \leq 1 \\
0 & \text { if } 0 \leq x \leq r_{n}
\end{array} .\right.
$$
Show $H(x)=\sum_{n=1}^{\infty} h_{n}(x) / 2^{n}$ is integrable on $[0,1]$ even though it has discontinuities at every rational point.
\end{exercise}
\begin{solution}
\(H_n(x) = \sum^n_{i=1} h_i(x) / 2^n\) is integrable and \((H_n)\) uniformly approaches \(H\).
\end{solution}

\begin{exercise}[Content Zero] A set $A \subseteq[a, b]$ has content zero if for every $\epsilon>0$ there exists a finite collection of open intervals $\left\{O_{1}, O_{2}, \ldots, O_{N}\right\}$ that contain $A$ in their union and whose lengths sum to $\epsilon$ or less. Using $\left|O_{n}\right|$ to refer to the length of each interval, we have
$$
A \subseteq \bigcup_{n=1}^{N} O_{n} \quad \text { and } \quad \sum_{n=1}^{N}\left|O_{n}\right| \leq \epsilon .
$$
\enum{
\item Let $f$ be bounded on $[a, b]$. Show that if the set of discontinuous points of $f$ has content zero, then $f$ is integrable.
\item Show that any finite set has content zero.
\item Content zero sets do not have to be finite. They do not have to be countable. Show that the Cantor set $C$ defined in Section $3.1$ has content zero.
\item Prove that
$$
h(x)= \begin{cases}1 & \text { if } x \in C \\ 0 & \text { if } x \notin C .\end{cases}
$$
is integrable, and find the value of the integral.
}
\end{exercise}
\begin{solution}
\enum{
\item Let \(\epsilon > 0\), let \(M\) be the difference between the maximum and minimum values of \(f\). Let \(A\) be the set of discontinuous points of \(f\), and choose \(\left\{O_{1}, \ldots, O_{N}\right\}\) so that \(\sum |O_n| < \epsilon / (2M)\). Assume without loss of generality that none of \(O_i\) overlap; if there was an overlapping pair then of intervals then they can be merged into a single interval.

Start a partition \(P\) with the endpoints of each \(O_i\), and note that the sum of \((M_k - m_k)\Delta x_k\) over the subintervals from each \(O_i\) is less than \(\epsilon/2\). Moreover over the remaining subintervals (of which there are finitely many) \(f\) is continuous and thus integrable, and so it is possible to refine \(P\) so that over the remaining subintervals the sum of \((M_k - m_k)\Delta x_k\) is less than \(\epsilon/2\).

Putting these together gets us that \(f\) is integrable.

\item Let this finite set \(A\) have \(N\) elements, then take \(V_\delta(x)\) where \(x \in A\) and \(\delta = \epsilon / N\).

\item Refer to Section 3.1 for the definition of \(C_n\). Let \(n\) be large enough so that the total length of the intervals in \(C_n\) is less than \(\epsilon/2\). Let \(C_{n,i}\) refer to the \(i\)'th interval in \(C_n\), and define \(O_i\) so that \(C_{n,i} \subset O_i\) and \(|O_i| - |C_{n,i}| = \delta\), where \(\delta < \epsilon/2^{n+1}\) is small enough so that \(\sum^{2^n}_{i=1} |O_i| - \sum^{2^n}_{i=1} |C_{n,i}| < \epsilon/2\).

\item \(C\) is closed and its complement is open; therefore the set of discontinuities of \(h\) is \(C\). Parts (a) and (c) imply \(h\) is integrable.

Exercises 3.5.8 and 3.5.9 show that the complement of \(C\) is dense, so for any partition \(P\), \(L(h, P) = 0\). Thus since \(h\) is integrable, the value of the integral must be 0.
}
\end{solution}
