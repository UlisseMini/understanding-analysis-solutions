\section{The Mean Value Theorems}

\begin{exercise}
  Recall from Exercise $4.4 .9$ that a function $f: A \rightarrow \mathbf{R}$ is Lipschitz on $A$ if there exists an $M>0$ such that
  $$
  \left|\frac{f(x)-f(y)}{x-y}\right| \leq M
  $$
  for all $x \neq y$ in $A$
  \enum{
  \item Show that if $f$ is differentiable on a closed interval $[a, b]$ and if $f^{\prime}$ is continuous on $[a, b]$, then $f$ is Lipschitz on $[a, b]$.
  \item Review the definition of a contractive function in Exercise 4.3.11. If we add the assumption that $\left|f^{\prime}(x)\right|<1$ on $[a, b]$, does it follow that $f$ is contractive on this set?
  }
\end{exercise}
\begin{solution}
  \enum{
  \item Since $f'$ is continuous on the compact set $[a,b]$ we can set $M$ such that $|f'(x)| \le M$ over $[a,b]$, then pick $x,y \in [a,b]$ with $x<y$. Apply MVT on $[x,y]$ to get a $c \in (x,y)$ with
    $$
    \frac{f(x)-f(y)}{x-y} = f'(c)
    $$
    Which implies
    $$
    \left|\frac{f(x)-f(y)}{x-y}\right| = |f'(c)| \le M
    $$
    Since $x,y$ were arbitrary this shows $f$ is Lipschitz.
  \item For $f$ to be contractive we need some $c \in (0, 1)$ with $|f(x)-f(y)| \le c|x-y|$.
    Set
    $$c = \sup \{|f'(x)| : x \in [a,b]\}$$
    Clearly $|f'(x)| \le c$, now apply the Extreme Value Theorem to find $d \in [a,b]$ with $|f'(d)| = c$, which implies $c < 1$ since $|f'(d)| < 1$.

    Now apply the MVT as in (a) to bound $|f(x) - f(y)| \le c|x-y|$, which shows $f$ is contractive.
  }
\end{solution}

\begin{exercise}
  Let $f$ be differentiable on an interval $A$. If $f^{\prime}(x) \neq 0$ on $A$, show that $f$ is one-to-one on $A$. Provide an example to show that the converse statement need not be true.
\end{exercise}
\begin{solution}
  Let $x,y$ be in $A$ with $x < y$, to show $f(x) \ne f(y)$ apply the Mean Value Theorem on $[x,y]$ to get $c \in (x,y)$ with
  $$
  f'(c) = \frac{f(x) - f(y)}{x-y}
  $$
  Now since $f'(c) \ne 0$ we must have $f(x) - f(y) \ne 0$, and thus $f(x) \ne f(y)$.

  To see the converse is false consider how $f(x) = x^3$ is 1-1 but has $f'(0) = 0$.
\end{solution}

\begin{exercise}
  Let $h$ be a differentiable function defined on the interval $[0,3]$, and assume that $h(0)=1, h(1)=2$, and $h(3)=2$.
  \enum{
  \item Argue that there exists a point $d \in[0,3]$ where $h(d)=d$.
  \item Argue that at some point $c$ we have $h^{\prime}(c)=1 / 3$.
  \item Argue that $h^{\prime}(x)=1 / 4$ at some point in the domain.
  }
\end{exercise}
\begin{solution}
  \enum{
  \item Consider $g(x) = h(x) - x$ which is continuous and has $g(0) = 1$ and $g(3) = -1$, then apply the IVT to find $d \in (0,3)$ with $g(d) = 0$ which implies $h(d) = d$.
  \item Apply MVT on $[0,3]$ to get $c \in (0,3)$ with
    $$h'(c) = \frac{h(0) - h(3)}{0 - 3} = 1/3$$
  \item We can find $c \in (0, 3)$ with $h'(c) = 1/3$ and a $d \in (1,3)$ with $h'(d) = 0$. So by Darboux's theorem there exists a point $x \in (c,d)$ with $h'(x) = 1/4$.
  }
\end{solution}

\begin{exercise}
  Let $f$ be differentiable on an interval $A$ containing zero, and assume $\left(x_{n}\right)$ is a sequence in $A$ with $\left(x_{n}\right) \rightarrow 0$ and $x_{n} \neq 0$.
  \enum{
  \item If $f\left(x_{n}\right)=0$ for all $n \in \mathbf N$, show $f(0)=0$ and $f^{\prime}(0)=0$.
  \item Add the assumption that $f$ is twice-differentiable at zero and show that $f^{\prime \prime}(0)=0$ as well.
  }
\end{exercise}
\begin{solution}
  \enum{
  \item Since $f'(0)$ exists and $f(x_n) = 0$ for all $n$ we have
    $$
    f'(0) = \lim \frac{f(x_n)}{x_n} = 0
    $$
  \item By the mean value theorem over $[0,x_n]$ there exists a $c_n \in (0,x_n)$ such that
    $$
    f'(c_n) = \frac{f(x_n)}{x_n}
    $$
    Then like in (a)
    $$
    f''(0) = \lim \frac{f'(c_n)}{c_n} = 0
    $$
  }
\end{solution}

\begin{exercise}
  \enum{
  \item Supply the details for the proof of Cauchy's Generalized Mean Value Theorem (Theorem 5.3.5).
  \item Give a graphical interpretation of the Generalized Mean Value Theorem analogous to the one given for the Mean Value Theorem at the beginning of Section 5.3. (Consider $f$ and $g$ as parametric equations for a curve.)
  }
\end{exercise}
\begin{solution}
  \enum{
  \item Let $h(x) = [f(b)-f(a)]g(x) - [g(b)-g(a)]f(x)$ and apply the MVT to $h$ to get $c \in (a,b)$ with
    $$
    h'(c) = \frac{h(b)-h(a)}{b-a} = \frac{[f(b)-f(a)][g(b)-g(a)] - [g(b)-g(a)][f(b)-f(a)]}{b-a} = 0
    $$
    Thus we have
    $$
    h'(c) = [f(b)-f(a)]g'(c) - [g(b)-g(a)]f'(c) = 0
    $$
    Completing the proof.
  \item Rename $x = f$, $g = y$, $t=a$, then the theorem states
    $$
    \frac{x'(t)}{y'(t)} = \frac{dx}{dy} = \frac{x(b)-x(a)}{y(b)-y(a)}
    $$
    In other words, it's the mean value theorem for parametric curves.
  }
\end{solution}

\begin{exercise}
  \enum{
  \item Let $g:[0, a] \rightarrow \mathbf{R}$ be differentiable, $g(0)=0$, and $\left|g^{\prime}(x)\right| \leq M$ for all $x \in[0, a] .$ Show $|g(x)| \leq M x$ for all $x \in[0, a] .$
  \item Let $h:[0, a] \rightarrow \mathbf{R}$ be twice differentiable, $h^{\prime}(0)=h(0)=0$ and $\left|h^{\prime \prime}(x)\right| \leq$ $M$ for all $x \in[0, a] .$ Show $|h(x)| \leq M x^{2} / 2$ for all $x \in[0, a] .$
  \item Conjecture and prove an analogous result for a function that is differentiable three times on $[0, a]$.
  }
\end{exercise}
\begin{solution}
  \enum{
  \item For $x \in [0,a]$, apply MVT to find a $c \in [0,x]$ with
    $$g'(c) = \frac{g(x)}{x} \implies g(x) = g'(c)x \implies |g(x)| \le Mx$$
  \item This is a special case of the theorem that if $f(0) = g(0) = 0$ and $f'(x) \le g'(x)$ for all $x \in [0,a]$ then $f(x) \le g(x)$. To prove this note how letting $h(x) = g(x) - f(x)$ changes the statement into $h'(x) \ge 0$ implying $h(x) \ge 0$. Which is true since MVT to get $c \in [0,x]$ implies $h'(c) = h(x)/x \ge 0$ thus $h(x) \ge 0$.

    Now returning to $|h''(x)| \le Mx^2/2$ apply the above result to both cases in the inequality
    $$
    \begin{aligned}
      -Mx^2/2 \le h''(x) \le Mx^2/2 &\implies -Mx \le h'(x) \le Mx \\
                                    &\implies -M \le h(x) \le M \\
                                    &\implies |h(x)| \le M
    \end{aligned}
    $$
    Which proves $|h(x)| \le M$.
  \item I conjecture $|f(x)| \le x^3/6$ when $f(0) = f'(0) = f''(0) = 0$. The proof is the same as (b), except we differentiate one more time.
  }
\end{solution}

\begin{exercise}
  A fixed point of a function $f$ is a value $x$ where $f(x)=x$. Show that if $f$ is differentiable on an interval with $f^{\prime}(x) \neq 1$, then $f$ can have at most one fixed point.
\end{exercise}
\begin{solution}
  Suppose for contradiction that $x,y$ are fixed points of $f$ with $x < y$, then apply MVT on $[x,y]$ to get
  $$
  f'(c) = \frac{f(x) - f(y)}{x - y} = \frac{x - y}{x - y} = 1
  $$
  But we know $f'(c) \ne 1$, therefore finding more then one fixed point is impossible.
\end{solution}

\begin{exercise}
  Assume $f$ is continuous on an interval containing zero and differentiable for all $x \neq 0$. If $\lim _{x \rightarrow 0} f^{\prime}(x)=L$, show $f^{\prime}(0)$ exists and equals $L$.
\end{exercise}
\begin{solution}
  Let $\delta > 0$ be such that $|f'(x) - L| < \epsilon$ whenever $0<|x|<\delta$,
  Fix an $x \in (0,\delta)$ and apply MVT on $(0,\delta)$ (possible since $f$ is differentiable on $(0,\delta)$) to get $c \in (0,\delta)$ with
  $$
  \frac{f(x) - f(0)}{x - 0} = f'(c)
  $$
  Subtracting $L$ from both sides and taking absolute values we see
  $$
  \left|\frac{f(x) - f(0)}{x - 0} - L\right| = \left|f'(c) - L\right| < \epsilon
  $$
  Since $x$ was arbitrary this holds for every $x \in (0,\delta)$, the same logic shows the inequality for every $x \in (-\delta,0)$. Therefor every $0 < |x| < \delta$ has
  $$
  \left|\frac{f(x) - f(0)}{x - 0} - L\right| < \epsilon
  $$
  Meaning the limit defining $f'(0)$ exists and equals $L$.
\end{solution}

\begin{exercise}
  Assume $f$ and $g$ are as described in Theorem 5.3.6, but now add the assumption that $f$ and $g$ are differentiable at $a$, and $f^{\prime}$ and $g^{\prime}$ are continuous at $a$ with $g^{\prime}(a) \neq 0$. Find a short proof for the $0 / 0$ case of L'Hospital's Rule under this stronger hypothesis.
\end{exercise}
\begin{solution}
  Let $(x_n)$ be a sequence approaching $a$ and apply MVT on $[x_n,a]$ to find $c_n,d_n \in (x_n,a)$ with
  $$
  f'(c_n) = \frac{f(x_n)}{x_n - a} \quad\text{and}\quad g'(d_n) = \frac{g(x_n)}{x_n - a}
  $$
  Meaning
  $$
  \lim \frac{f(x_n)}{g(x_n)} = \lim \frac{f'(c_n)/(x_n-a)}{g'(d_n)/(x_n-a)} = \lim \frac{f'(c_n)}{g'(d_n)}
  $$
  The continuity of $f'$ and $g'$ combined with $g'(a) \ne 0$ implies the limit exists
  $$
  \lim \frac{f'(c_n)}{g'(d_n)} = \frac{f'(a)}{g'(a)} = L
  $$
  Since we showed $\lim f(x_n)/g(x_n) = L$ \emph{for all} sequences $(x_n)$ the Sequential Criterion for Functional Limits (Theorem 4.2.3) implies
  $$
  \lim_{x \to a} \frac{f(x)}{g(x)} = L
  $$
  Which completes the proof.
\end{solution}

\begin{exercise}
  Let $f(x)=x \sin \left(1 / x^{4}\right) e^{-1 / x^{2}}$ and $g(x)=e^{-1 / x^{2}}$. Using the familiar properties of these functions, compute the limit as $x$ approaches zero of $f(x), g(x), f(x) / g(x)$, and $f^{\prime}(x) / g^{\prime}(x)$. Explain why the results are surprising but not in conflict with the content of Theorem 5.3.6. ${ }^{1}$
\end{exercise}
\begin{solution}
  $$
  \lim_{x \to 0} f(x) = 0,
  \quad \lim_{x \to 0} g(x) = 0,
  \quad \lim_{x \to 0} \frac{f(x)}{g(x)} = 0,
  $$
  To compute the last limit we need to find $f'$ and $g'$ using derivative rules. Let $h(x) = x\sin(1/x^4)$ for bookkeeping.
  $$
  \begin{aligned}
    g'(x) &= \frac{d}{dx} e^{-x^{-2}} = e^{-x^{-2}}(2x^{-3}) = g(x)(2x^{-3}) \\
    h'(x) &= \sin(x^{-4}) + x\cos(x^{-4})(-4x^{-5}) = \sin(x^{-4}) - 4x^{-4}\cos(x^{-4})\\
    f'(x) &= \frac{d}{dx} h(x)g(x) \\
          &= h'(x)g(x) + g(x)(2x^{-3})h(x) \\
          &= g(x)(h'(x) + 2x^{-3}h(x))
  \end{aligned}
  $$
  We can simplify by dividing out $g(x)$
  $$
  \frac{f'(x)}{g'(x)}
  = \frac{g(x)(h'(x) + 2x^{-3}h(x))}{g(x)(2x^{-3})}
  = \frac{h'(x) + 2x^{-3}h(x)}{2x^{-3}}
  = \frac 12 x^3h'(x) + h(x)
  $$
  Now we can compute the limit
  $$
  \begin{aligned}
  \lim_{x \to 0}\left[\frac 12 x^3 h'(x) + h(x)\right]
  &= \lim_{x \to 0} \frac 12 x^3 h'(x) &&{\text{since } \lim_{x\to 0} h(x) = 0} \\
  &= \frac 12 \lim_{x \to 0}\left[x^3\sin(x^{-4}) - 4x^{-1}\cos(x^{-4})\right] &&{\text{substitute } h'} \\
  &= -2 \lim_{x \to 0} x^{-1}\cos(x^{-4}) &&{\text{since } \lim_{x \to 0} x^3\sin(x^{-4}) = 0} \\
  &\to \text{does not exist, just like } \lim_{x \to 0} 1/x
  \end{aligned}
  $$
  L'Hospital's rule for $0/0$ would apply if $f'/g'$ existed. but when it doesn't exist $f/g$ may still exist, that's a bit surprising.
  % TODO: I feel I'm missing something here
\end{solution}

\begin{exercise}
  \enum{
  \item Use the Generalized Mean Value Theorem to furnish a proof of the $0 / 0$ case of L'Hospital's Rule (Theorem 5.3.6).
  \item If we keep the first part of the hypothesis of Theorem 5.3.6 the same but we assume that
    $$
    \lim _{x \rightarrow a} \frac{f^{\prime}(x)}{g^{\prime}(x)}=\infty
    $$
    does it necessarily follow that
    $$
    \lim _{x \rightarrow a} \frac{f(x)}{g(x)}=\infty ?
    $$
  }
\end{exercise}
\begin{solution}
  % TODO: Remove h, use (a,x) with x>a and WOLG.
  \enum{
  \item Let $f,g$ be continuous functions with $f(a) = g(a) = 0$ and $f'(x) \ne 0$, $g'(x) \ne 0$, suppose
    $$
    \lim_{x\to a} \frac{f'(x)}{g'(x)} = L
    $$
    We would like to show $\lim_{x\to a} \frac{f(x)}{g(x)} = L$. Choose $\epsilon > 0$ then let $\delta > 0$ be such that
    $$
    \left|\frac{f'(x)}{g'(x)} - L\right| < \epsilon
    $$
    Let $0 < h < \delta$ apply the generalized mean value theorem on $(a,a+h)$ to get a $c \in (a,a+h)$ with
    $$
    \frac{f(a+h)-f(a)}{g(a+h)-g(a)} = \frac{f'(c)}{g'(c)}
    $$
    Subtract $L$ from both sides and take absolute values, (and use $f(a) = g(a) = 0$) to get
    $$
    \left|\frac{f(a+h)}{g(a+h)} - L\right| < \epsilon
    $$
    Since $h$ was an arbitrary number less than $\delta$, and since we could just as easily have applied MVT to $(a-h,a)$ we have
    $$
    \left|\frac{f(x)}{g(x)} - L\right| < \epsilon, (0 < |x| < \delta)
    \implies
    \lim_{x\to a} \frac{f(a+h)}{g(a+h)} = L
    $$
    as desired.
  \item Choose $M > 0$ and let $\delta > 0$ be such that $0<|x-a|<\delta$ implies $f'(x)/g'(x) > M$. Let $0 < h < \delta$ be arbitrary, then apply MVT on $(a,a+h)$ to get $c \in (a,a+h)$ with
    $$
    \frac{f(a+h)}{g(a+h)} = \frac{f'(c)}{g'(c)}
    $$
    Since $f'(c)/g'(c) > M$, this implies
    $$
    \frac{f(a+h)}{g(a+h)} > M
    $$
    for all $0 < h < \delta$, but again, we could just as easily apply this reasoning to $(a-h,a)$ (getting $f(a-h)/g(a-h) > M$). So, after a change of variables removing $h$ we have, for all $x$ with $0 < |x-a| < \delta$
    $$
    \frac{f(x)}{g(x)} > M
    $$
    Which is clearly the same as saying $\lim_{x\to a} f(x)/g(x) = \infty$.
  }
\end{solution}

\begin{exercise}
  If $f$ is twice differentiable on an open interval containing $a$ and $f^{\prime \prime}$ is continuous at $a$, show
  $$
  \lim _{h \rightarrow 0} \frac{f(a+h)-2 f(a)+f(a-h)}{h^{2}}=f^{\prime \prime}(a) .
  $$
  (Compare this to Exercise 5.2.6(b).)
\end{exercise}
\begin{solution}
  \TODO
\end{solution}

